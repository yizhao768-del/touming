<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>小透明的少女心抽奖</title>
  <meta name="description" content="精致可爱、少女心十足的抽奖页面，固定奖品顺序展示，适合直接部署在 GitHub Pages。" />
  <style>
    :root{
      --pink:#ff9ecf;
      --pink-2:#ffb7dc;
      --rose:#ff6fa1;
      --lav:#c7b7ff;
      --cream:#fff7fb;
      --deep:#874a74;
      --shadow: 0 10px 30px rgba(255, 105, 180, .25);
      --radius: 22px;
    }

    /* 全局与背景 */
    html,body{height:100%;}
    body{
      margin:0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display","PingFang SC","Hiragino Sans GB","Microsoft YaHei", Helvetica, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% -10%, #ffe6f5 0%, #fff 40%),
                  radial-gradient(800px 600px at 120% 10%, #ffe9ff 0%, #fff 50%),
                  linear-gradient(180deg, #fff 0%, #fff 100%);
      color:#4b2a3d; -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
      overflow-x:hidden;
    }

    /* 漂浮小心心 */
    .float-heart{ position:fixed; pointer-events:none; opacity:.16; animation: float 12s linear infinite;}
    .float-heart::before{content:"❤"; font-size:28px; color: var(--pink); text-shadow:0 0 10px rgba(255, 158, 207,.35)}
    @keyframes float{ 0%{ transform: translateY(100vh) scale(.8) rotate(0);} 100%{ transform: translateY(-20vh) scale(1.2) rotate(360deg);} }

    /* 容器卡片 */
    .wrap{
      min-height:100%; display:flex; align-items:center; justify-content:center; padding:20px;
    }
    .card{
      width:min(520px, 95vw); background: linear-gradient(180deg, #fff, var(--cream));
      border-radius: var(--radius); box-shadow: var(--shadow);
      position:relative; overflow:hidden; border:1px solid #ffd6eb;
    }
    .ribbon{
      position:absolute; inset:0; pointer-events:none; opacity:.4;
      background:
      radial-gradient(800px 120px at 50% -20%, rgba(255, 182, 219,.45), transparent 60%),
      radial-gradient(120px 120px at 10% 20%, rgba(199,183,255,.45), transparent 60%),
      radial-gradient(160px 160px at 90% 10%, rgba(255,223,240,.7), transparent 60%);
      filter: blur(8px);
    }

    header{
      padding:28px 22px 0; text-align:center;
    }
    .title{
      font-size:26px; font-weight:800; color:var(--deep); letter-spacing:1px;
      text-shadow:0 2px 0 #ffd4ea, 0 8px 22px rgba(255, 158, 207,.45);
    }
    .subtitle{ margin-top:10px; font-size:14px; color:#7e4e6d; opacity:.9;}

    .content{ padding:24px 20px 16px; display:flex; flex-direction:column; align-items:center; gap:14px; }

    .panel{
      width:100%; background:linear-gradient(180deg, #fff, #fff7fb); border-radius:18px; border:1px dashed #ffcbe6; padding:18px 16px; text-align:center;
    }
    .msg{ font-size:18px; line-height:1.7; }
    .prize{ font-size:22px; font-weight:900; color:#c23f7a; text-shadow:0 1px 0 #fff; }
    .note{ font-size:14px; color:#8a5a78; }

    /* 3D 按钮 */
    .btn{ appearance:none; border:none; cursor:pointer; padding:14px 22px; border-radius:14px; font-size:18px; font-weight:800; letter-spacing:.5px;
      background: radial-gradient(120% 140% at 30% 20%, #ffd1ea 0%, #ffb5dd 45%, #ff8fc6 100%);
      color:#6d234c; box-shadow: 0 10px 0 #ff78b9, 0 14px 24px rgba(255, 120, 185, .35);
      transition: transform .08s ease, box-shadow .08s ease; width: 90%; max-width: 340px;
    }
    .btn:active{ transform: translateY(4px); box-shadow: 0 6px 0 #ff78b9, 0 10px 16px rgba(255,120,185,.3); }
    .btn[disabled]{ opacity:.65; cursor:not-allowed; }

    /* 等待动画 */
    .loading{ display:flex; align-items:center; justify-content:center; gap:10px; height:72px; }
    .heart{ width:14px; height:14px; background: var(--rose); transform: rotate(45deg); position:relative; box-shadow:0 6px 18px rgba(255,111,161,.4) inset, 0 0 0 4px rgba(255,255,255,.6) inset; animation: beat 1.1s infinite ease-in-out; }
    .heart::before,.heart::after{ content:""; position:absolute; width:14px; height:14px; background:var(--rose); border-radius:50%; }
    .heart::before{ top:-7px; left:0; }
    .heart::after{ left:-7px; top:0; }
    .heart:nth-child(2){ animation-delay:.15s; filter:hue-rotate(20deg)}
    .heart:nth-child(3){ animation-delay:.3s; filter:hue-rotate(40deg)}
    @keyframes beat{ 0%,100%{ transform: rotate(45deg) scale(.85);} 50%{ transform: rotate(45deg) scale(1.12);} }

    /* 小标签 */
    .tag{ display:inline-block; padding:6px 10px; background: #fff; border:1px solid #ffd2ea; border-radius:999px; font-size:12px; color:#a15383; box-shadow: 0 6px 16px rgba(255,182,219,.3);
    }

    footer{ padding: 6px 16px 24px; text-align:center; font-size:12px; color:#a16a8c; }
    .tiny{ opacity:.85 }

    /* iOS 视觉优化 */
    @supports (backdrop-filter: blur(6px)){
      .card{ backdrop-filter: blur(3px); }
    }

    /* 深色模式保护（可选） */
    @media (prefers-color-scheme: dark){
      body{ background: radial-gradient(1200px 800px at 20% -10%, #3b2d3b 0%, #2a1f2a 40%), linear-gradient(180deg, #2a1f2a, #241b24); color:#ffe7f5; }
      .card{ background: linear-gradient(180deg, #3b2d3b, #2a1f2a); border-color:#5a3e56 }
      .panel{ background:linear-gradient(180deg, #48344a, #3a2a3c); border-color:#6c4865 }
      .title{ text-shadow:none; color:#ffe5f4 }
      .btn{ color:#3c0f28 }
      .note,.subtitle,.tiny{ color:#f9dcec }
    }
    /* 终章艺术字 */
  .hero-text{ font-size:26px; font-weight:900; line-height:1.5; text-align:center; padding:14px 8px; letter-spacing:.6px;
    background: linear-gradient(90deg, #ff6fa1, #ffb7dc, #c7b7ff 80%);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow: 0 2px 0 rgba(255,255,255,.95), 0 10px 28px rgba(255, 143, 198, .55), 0 0 1px rgba(255,255,255,.6);
  }
  .hero-text::after{ content:""; display:block; width:82%; height:8px; margin:10px auto 0; border-radius:999px;
    background: radial-gradient(30px 8px at 10% 50%, rgba(255,182,219,.7), transparent 60%),
                radial-gradient(30px 8px at 50% 50%, rgba(199,183,255,.7), transparent 60%),
                radial-gradient(30px 8px at 90% 50%, rgba(255,223,240,.8), transparent 60%);
    filter: blur(.3px); opacity:.7;
  }
  @media (max-width: 420px){ .hero-text{ font-size:22px; } }
  /* 结果面板 reveal 微动效 */
  .reveal{ animation: reveal .18s ease-out both; will-change: transform, opacity, filter; }
  @keyframes reveal{ from{ opacity:0; transform: scale(.98); filter: blur(6px); } to{ opacity:1; transform: scale(1); filter: blur(0); } }
  @media (prefers-reduced-motion: reduce){ .reveal{ animation:none; } }
</style>
</head>
<body>
  <!-- 背景漂浮心心（轻量、稳定、无需外部资源） -->
  <span class="float-heart" style="left:6vw; animation-duration: 14s; animation-delay:0s"></span>
  <span class="float-heart" style="left:22vw; animation-duration: 18s; animation-delay:1s"></span>
  <span class="float-heart" style="left:48vw; animation-duration: 16s; animation-delay:.5s"></span>
  <span class="float-heart" style="left:76vw; animation-duration: 20s; animation-delay:2.2s"></span>

  <div class="wrap">
    <div class="card" role="region" aria-label="抽奖卡片">
      <div class="ribbon" aria-hidden="true"></div>
      <header>
        <div class="title">小透明的特别抽奖福利</div>
        
      </header>

      <main class="content">
        <div class="panel" id="panel">
          <div class="msg" id="message">小透明恭喜你获得特别抽奖福利，你准备好了吗？</div>
        </div>
        <button class="btn" id="actionBtn" aria-live="polite">确定</button>
        <div class="tag" id="hint">点击确定开始抽奖</div>
      </main>

      <footer>
        <div class="tiny">© 小玉为小透明特别定制 · GitHub Pages 单文件可用</div>
      </footer>
    </div>
  </div>

  <!-- 轻量 confetti，无外部依赖 -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-labelledby="overlayMsg">
  <div class="overlay-card">
    <div class="overlay-msg" id="overlayMsg">哇恭喜透明运气太好了，奖励再来一次</div>
    <button class="btn" id="overlayBtn">确定</button>
  </div>
</div>
<canvas id="confetti" style="position:fixed; inset:0; pointer-events:none"></canvas>

  <script>
  ;(() => {
    const panel = document.getElementById('panel');$1const hint = document.getElementById('hint');

    // 仪式感覆盖层
    const overlay = document.getElementById('overlay');
    const overlayMsg = document.getElementById('overlayMsg');
    const overlayBtn = document.getElementById('overlayBtn');
    let needOverlayAfterFirst = false;

    // 固定奖品顺序（稳定可复现）
    const steps = [
      { type:'draw', prize:'52元红包', note:'哇恭喜透明运气太好了，奖励再来一次' },
      { type:'draw', prize:'无畏契约任意皮肤一个（选好告诉小玉领取）', note:'今天是透明的幸运日，免费再次奖励三次抽奖' },
      { type:'draw', prize:'无条件要求劵（仅可对小玉使用）', note:'' },
      { type:'draw', prize:'赛博小蛋糕（联系小玉领取）', note:'' },
        /* 仪式感覆盖层（二次确认页） */
  .overlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(255, 240, 248, .82); backdrop-filter: blur(6px); z-index:999; padding:22px; }
  .overlay-card{ width:min(520px,92vw); background:linear-gradient(180deg,#fff,#fff7fb); border:1px solid #ffd6eb; border-radius:22px; box-shadow: var(--shadow); padding:24px 18px; text-align:center; }
  .overlay-msg{ font-size:18px; color:#7e4e6d; line-height:1.8; margin-bottom:14px; }
  .overlay .btn{ width:80%; max-width:280px; }

  /* 手机适配优化 */
  @media (max-width: 420px){
    .title{ font-size:22px; }
    .msg{ font-size:16px; }
    .prize{ font-size:20px; }
    .panel{ padding:16px 12px; }
    .btn{ width: 96%; font-size:17px; }
  }
</style>
    ];

    let started = false;
    let idx = -1; // 当前 steps 下标

    function setLoading(){
      panel.innerHTML = `
        <div class="loading" aria-live="polite" aria-busy="true">
          <div class="heart"></div><div class="heart"></div><div class="heart"></div>
        </div>
        <div class="note">抽奖进行中，请稍候…</div>
      `;
      btn.disabled = true;
      hint.textContent = '正在抽奖…';
    }

    function showPrize(p){$1
      // 触发 reveal 动画（先移除再强制重排以便二次触发）
      panel.classList.remove('reveal');
      void panel.offsetWidth;
      panel.classList.add('reveal');
      btn.disabled = false;
      btn.textContent = idx === steps.length - 1 ? '完成' : '确定';
      hint.textContent = idx === steps.length - 1 ? '已到最后一项奖品' : '继续抽下一个';
      if(idx === 0){ needOverlayAfterFirst = true; }
      burstConfetti();
    }</div>
        <div class="prize" style="${isParagraph? 'font-size:18px; line-height:1.8; font-weight:700;' : ''}">${p.prize}</div>
        ${ p.note ? `<div class="note" style="margin-top:8px">${p.note}</div>` : ''}
      `;
      btn.disabled = false;
      btn.textContent = idx === steps.length - 1 ? '完成' : '确定';
      hint.textContent = idx === steps.length - 1 ? '已到最后一项奖品' : '继续抽下一个';
      burstConfetti();
    }

    function next(){
      if(!started){
        started = true;
        hint.textContent = '好运来啦～';
      }
      idx++;
      if(idx >= steps.length){
        panel.innerHTML = `
          <div class="hero-text">小透明不止今天，<br/>每一天都是你的幸运日！！！</div>
        `;
        btn.style.display = 'none';
        hint.textContent = '';
        burstConfetti();
        return;
      }

      // 抽奖动画
      setLoading();
      setTimeout($1, 2200);
    }

    btn.addEventListener('click', () => {
      if (btn.disabled) return; // 防误触
      if (needOverlayAfterFirst){
        overlayMsg.textContent = '哇恭喜透明运气太好了，奖励再来一次';
        overlay.style.display = 'flex';
        needOverlayAfterFirst = false;
        return;
      }
      next();
    });

    // ======= 轻量 confetti 实现（Canvas） =======
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let W, H; let pieces = []; let rafId;

    function resize(){ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    function rand(min, max){ return Math.random() * (max - min) + min; }

    function makeConfetti(){
      const colors = ['#ff79b5','#ffb6dc','#ffd6ea','#c7b7ff','#fff0f8'];
      for(let i=0;i<70;i++){
        pieces.push({
          x: rand(0, W), y: -10, w: rand(6,10), h: rand(10,16),
          vy: rand(2, 4), vx: rand(-1,1), rot: rand(0, Math.PI), vr: rand(-0.1, 0.1),
          color: colors[(Math.random()*colors.length)|0]
        });
      }
    }

    function draw(){
      ctx.clearRect(0,0,W,H);
      pieces.forEach(p => {
        ctx.save();
        ctx.translate(p.x, p.y); ctx.rotate(p.rot);
        ctx.fillStyle = p.color; ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
        ctx.restore();
        p.x += p.vx; p.y += p.vy; p.rot += p.vr;
      });
      pieces = pieces.filter(p => p.y < H + 20);
      rafId = requestAnimationFrame(draw);
    }

    function burstConfetti(){$1}

    // 打字机效果
    function typeWriter(text, el, speed){
      el.textContent = '';
      const chars = text.split('');
      let i = 0;
      const timer = setInterval(() => {
        el.textContent += chars[i];
        i++;
        if(i >= chars.length){ clearInterval(timer); }
      }, speed);
    }

    // 覆盖层按钮：关闭并进入下一步
    // 打字机Pro：节奏变化 + 终行心形闪烁一次
    function typeWriterPro(text, el, onDone){
      el.textContent = '';
      const heart = document.createElement('span');
      heart.className = 'blink-heart';
      heart.textContent = '❤';
      const arr = text.split('');
      let i = 0;
      const key = '生日快乐';
      (function tick(){
        if(i >= arr.length){
          el.appendChild(heart);
          requestAnimationFrame(()=> heart.classList.add('show'));
          setTimeout(()=> { heart.remove(); onDone && onDone(); }, 900);
          return;
        }
        const ch = arr[i++];
        el.textContent += ch;
        let delay = 28;
        if(/[，。！？、,.!?]/.test(ch)) delay = 120;
        if(el.textContent.endsWith(key)){
          el.style.display = 'inline-block';
          el.animate([{transform:'scale(1)'},{transform:'scale(1.04)'}], {duration:220, easing:'ease-out'});
          delay = 220;
        }
        setTimeout(tick, delay);
      })();
    }

    overlayBtn.addEventListener('click', () => {
      overlay.style.display = 'none';
      next();
    });

  })();
  </script>
</body>
</html>
